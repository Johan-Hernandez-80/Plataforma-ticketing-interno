# Casos de prueba para autenticación

El objetivo de este documento es preparar los casos de prueba
basados en las historias de usuario para los endpoints de la
`API` relacionados a la autenticación

La autenticación esta basada en un `JWT`(Json web token)
que permite tener seguridad en toda la `API`

El único endpoint que no tiene seguridad es `/auth/login`,
todos los demás deben exigir una cabecera `Authorization: Bearer <token>`

---

- `CP-01`
- **Caso de Prueba**: Generar un token de sesión
- **Endpoint**: `/auth/login`
- **Método HTTP**: `POST`
- **Descripción**: Autentica un usuario usando email y contraseña y genera
  un `JWT`.
- **Parámetros**: Requiere un cuerpo con la siguiente estructura

```json
{
  "email": "string",
  "password": "string"
}
```

- **Headers**: Ninguno.
- **Código de Respuesta Esperado**: `200 OK`
- **Prueba Exitosa si**: La API devuelve un código `200 OK` con el
  siguiente cuerpo en la respuesta

```json
{
  "token": "<jwt-token>"
}
```

---

- `CP-02`
- **Caso de Prueba**: Validar cuando el email y/o contraseña es incorrecto
- **Endpoint**: `/auth/login`
- **Método HTTP**: `POST`
- **Descripción**: Valida que la API rechace el inicio de sesión cuando
  el email o la contraseña son incorrectos.
- **Parámetros**: Requiere un cuerpo con la siguiente estructura

```json
{
  "email": "string",
  "password": "string"
}
```

- **Headers**: Ninguno.
- **Código de Respuesta Esperado**: `401 Unauthorized`
- **Prueba Exitosa si**: La API devuelve un código `401 Unauthorized` con un
  mensaje adecuado

---

- `CP-03`
- **Caso de Prueba**: Validar cuando se accede a un endpoint con token invalido
- **Endpoint**: `Todo endpoint excepto /auth/login`
- **Método HTTP**: `Segun el endpoint`
- **Descripción**: Valida que se impida el acceso a un endpoint sin autenticación
  correcta
- **Parámetros**: Depende del endpoint
- **Headers**: `Authorization: Bearer <token>`
- **Código de Respuesta Esperado**: `403 Forbidden`
- **Prueba Exitosa si**: La API devuelve un código `403 Forbidden` con un
  mensaje adecuado
